url <- paste0(base_url, "/v2/services/export/observations?customId=ee73ca99-153d-4387-a97e-10c024f1ad25")
library(httr)
library(jsonlite)
library(dplyr)
library(writexl)
library(readxl)
#get the API token from your environment file
readRenviron(paste0(getwd(), "./.Renviron"))
token <- Sys.getenv("api_token")
base_url = 'https://bcenv-enmods-test.aqsamples.ca/api/'
url <- paste0(base_url, "/v2/services/export/observations?customId=ee73ca99-153d-4387-a97e-10c024f1ad25")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
x
url <- paste0(base_url, "v2/services/export/observations?customId=ee73ca99-153d-4387-a97e-10c024f1ad25")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
x
fromJSON(rawToChar(x$content))
View(x)
x$content
rawToChar(x$content)
url <- paste0(base_url, "v2/services/export/observations")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
x
x$content
x$request$output
rawToChar(x$content)
data <- rawToChar(x$content)
data
data <- rawToChar(x$content)
write.csv(data, "test_file.csv")
GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
data <- fromJSON(rawToChar(x$content))
rawToChar(x$content)
url <- paste0(base_url, "v2/services/export/observations?limit=10")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
data <- fromJSON(rawToChar(x$content))
data <- rawToChar(x$content)
write.csv(data, "test_file_2.csv")
data
class(data)
x<-read.table(text = data, sep = ",", fill = TRUE, as.is = TRUE)
?read.table
readRenviron(paste0(getwd(), "./.Renviron"))
token <- Sys.getenv("api_token")
base_url = 'https://bcenv-enmods-test.aqsamples.ca/api/'
url <- paste0(base_url, "v2/services/export/observations?limit=10")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
data <- rawToChar(x$content)
data_table <-read.table(text = data, sep = ",", fill = TRUE, as.is = TRUE)
View(data_table)
View(data_table)
url <- paste0(base_url, "v2/services/export/observations")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
data <- rawToChar(x$content)
data_table <-read.table(text = data, sep = ",", fill = TRUE, as.is = TRUE)
View(data_table)
url <- paste0(base_url, "v2/services/export/observations?format=csv")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
x
x$cookies
x$status_code
x$content
x$request
data <- rawToChar(x$content)
data
data_table <-read.table(text = data, sep = ",", fill = TRUE, as.is = TRUE) #also 245...
View(data_table)
x
View(x)
rm(x)
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
x
class(x)
httr::content(x)
dat <- httr::content(x)
View(dat)
url <- paste0(base_url, "v2/services/export/observations")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x)
View(dat)
url <- paste0(base_url, "v2/services/export/observations?limit=10")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x)
url <- paste0(base_url, "v2/services/export/observations?customId=0500236")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x) #494 rows
url <- paste0(base_url, "v2/services/export/observations?samplingLocations=ee73ca99-153d-4387-a97e-10c024f1ad25")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x) #494 rows
View(dat)
url <- paste0(base_url, "v2/services/export/observations?samplingLocationIds=ee73ca99-153d-4387-a97e-10c024f1ad25")
data_body <- list()
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x) #494 rows
url <- paste0(base_url, "v2/services/export/observations?samplingLocationIds=ee73ca99-153d-4387-a97e-10c024f1ad25,5e6ca29d-9b53-42f6-a52b-1ee40fd4b8ab")
x<-GET(url, config = c(add_headers(.headers = c('Authorization' = token))), body = data_body, encode = 'json')
#put the export into a nice data frame object
dat <- httr::content(x) #494 rows
